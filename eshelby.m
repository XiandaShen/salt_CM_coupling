% eshelby tensor
function S=eshelby(a,b,c)
v=0.3;
theta=asin(sqrt(1-c^2/a^2));  % 1
k=sqrt(a^2-b^2)/sqrt(a^2-c^2);
F=ellipticF(theta,k^2);
E=ellipticE(theta,k^2);

Ia=4*pi*a*b*c/sqrt(a^2-c^2)/(a^2-b^2)*(F-E);
Ic=4*pi*a*b*c/sqrt(a^2-c^2)/(b^2-c^2)*(b*sqrt(a^2-c^2)/a/c-E); % 2
Ib=4*pi-Ia-Ic;

Iab=(Ib-Ia)/(3*a^2-3*b^2);
Iac=(Ic-Ia)/(3*a^2-3*c^2);
Iaa=4*pi/3/a^2-Iab-Iac;

Ibc=(Ic-Ib)/(3*b^2-3*c^2);
Ibb=4*pi/3/b^2-Iab-Ibc;
Icc=4*pi/3/c^2-Iac-Ibc;

S(1:3,1:3,1:3,1:3)=0;
Q=3/(8*pi*(1-v));
R=(1-2*v)/(8*pi*(1-v));

S(1,1,1,1)=Q*a^2*Iaa+R*Ia;
S(1,1,1,2)=0;
S(1,1,1,3)=0;
S(1,1,2,1)=0;
S(1,1,2,2)=Q*b^2*Iab-R*Ia;
S(1,1,2,3)=0;
S(1,1,3,1)=0;
S(1,1,3,2)=0;
S(1,1,3,3)=Q*c^2*Iac-R*Ia;
S(1,2,1,1)=0;
S(1,2,1,2)=Q*(a^2+b^2)/2*Iab+R*(Ia+Ib)/2;
S(1,2,1,3)=0;
S(1,2,2,1)=Q*(a^2+b^2)/2*Iab+R*(Ia+Ib)/2;
S(1,2,2,2)=0;
S(1,2,2,3)=0;
S(1,2,3,1)=0;
S(1,2,3,2)=0;
S(1,2,3,3)=0;
S(1,3,1,1)=0;
S(1,3,1,2)=0;
S(1,3,1,3)=Q/2*(a^2+c^2)*Iac+R/2*(Ia+Ic);
S(1,3,2,1)=0;
S(1,3,2,2)=0;
S(1,3,2,3)=0;
S(1,3,3,1)=Q/2*(a^2+c^2)*Iac+R/2*(Ia+Ic);
S(1,3,3,2)=0;
S(1,3,3,3)=0;
S(2,1,1,1)=0;
S(2,1,1,2)=Q*(a^2+b^2)/2*Iab+R*(Ia+Ib)/2;
S(2,1,1,3)=0;
S(2,1,3,1)=0;
S(2,1,3,2)=0;
S(2,1,3,3)=0;
S(2,1,2,1)=Q*(a^2+b^2)/2*Iab+R*(Ia+Ib)/2;
S(2,1,2,2)=0;
S(2,1,2,3)=0;
S(2,1,3,1)=0;
S(2,1,3,2)=0;
S(2,1,3,3)=0;
S(2,2,1,1)=Q*a^2*Iab-R*Ib;
S(2,2,1,2)=0;
S(2,2,1,3)=0;
S(2,2,2,1)=0;
S(2,2,2,2)=Q*b^2*Ibb+R*Ib;
S(2,2,2,3)=0;
S(2,2,3,1)=0;
S(2,2,3,2)=0;
S(2,2,3,3)=Q*c^2*Ibc-R*Ib;
S(2,3,1,1)=0;
S(2,3,1,2)=0;
S(2,3,1,3)=0;
S(2,3,2,1)=0;
S(2,3,2,2)=0;
S(2,3,2,3)=Q/2*(b^2+c^2)*Ibc+R/2*(Ib+Ic);
S(2,3,3,1)=0;
S(2,3,3,2)=Q/2*(b^2+c^2)*Ibc+R/2*(Ib+Ic);
S(2,3,3,3)=0;
S(3,1,1,1)=0;
S(3,1,1,2)=0;
S(3,1,1,3)=Q/2*(a^2+c^2)*Iac+R/2*(Ia+Ic);
S(3,1,2,1)=0;
S(3,1,2,2)=0;
S(3,1,2,3)=0;
S(3,1,3,1)=Q/2*(a^2+c^2)*Iac+R/2*(Ia+Ic);
S(3,1,3,2)=0;
S(3,1,3,3)=0;
S(3,2,1,1)=0;
S(3,2,1,2)=0;
S(3,2,1,3)=0;
S(3,2,2,1)=0;
S(3,2,2,2)=0;
S(3,2,2,3)=Q/2*(b^2+c^2)*Ibc+R/2*(Ib+Ic);
S(3,2,3,1)=0;
S(3,2,3,2)=Q/2*(b^2+c^2)*Ibc+R/2*(Ib+Ic);
S(3,2,3,3)=0;
S(3,3,1,1)=Q*a^2*Iac-R*Ic;
S(3,3,1,2)=0;
S(3,3,1,3)=0;
S(3,3,2,1)=0;
S(3,3,2,2)=Q*b^2*Ibc-R*Ic;
S(3,3,3,1)=0;
S(3,3,3,2)=0;
S(3,3,3,3)=Q*c^2*Icc+R*Ic;
end




